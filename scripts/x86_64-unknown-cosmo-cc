:<<BASH_SECTION_START
@echo off
REM ----------------------- bash/batch polyglot file. ------------------------
REM  ----------- The batch front: re-executes this file under Bash -----------
REM  - Implemented using the here-doc technique, combined with a batch label -
REM  --- Command.com requires a batch script to use extension .bat or .cmd ---
REM  ------ WARNING - THIS FILE MUST BE SAVED WITH LF LINE ENDINGS ONLY ------
REM  -------------------------> See .gitattributes! <-------------------------

call "%~dp0..\polyglot\execute_as_bash.bat" "%~f0" %*
exit /b %ERRORLEVEL%

BASH_SECTION_START
#!/bin/sh
# Wrapper script for Cosmopolitan C compiler
# This polyglot works as both batch and shell script

SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
ROOT="$(cd "$SCRIPT_DIR/.." && pwd)"
COSMO_DIR="$ROOT/cosmocc"
COSMO_CC="$COSMO_DIR/bin/x86_64-unknown-cosmo-cc"

# Try .exe version first (for Windows), then fall back to base name
if [ -f "$COSMO_CC.exe" ]; then
    exec "$COSMO_CC.exe" "$@"
elif [ -f "$COSMO_CC" ]; then
    exec "$COSMO_CC" "$@"
else
    echo "Error: Cosmopolitan compiler not found at $COSMO_CC" >&2
    exit 1
fi

